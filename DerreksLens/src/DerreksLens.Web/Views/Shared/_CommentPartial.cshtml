@model DerreksLens.Application.DTOs.Comments.CommentDto

<div class="flex gap-4 group" id="comment-@Model.Id">
    <div class="flex-shrink-0">
        <div class="w-10 h-10 rounded-full flex items-center justify-center font-bold text-sm
            @(Model.IsAdmin ? "bg-accent text-background" : "bg-slate-700 text-slate-300")">
            @Model.Username.Substring(0, 1).ToUpper()
        </div>
    </div>

    <div class="flex-grow">
        <div class="flex items-center gap-2 mb-1">
            <span class="font-bold text-sm @(Model.IsAdmin ? "text-accent" : "text-white")">
                @Model.Username
                @if (Model.IsAdmin)
                {
                    <span class="text-[10px] border border-accent px-1 rounded ml-1">ADMIN</span>
                }
            </span>
            <span class="text-xs text-slate-500">@Model.CreatedAt.ToString("MMM dd, HH:mm")</span>
        </div>

        <div class="text-slate-300 text-sm mb-2 leading-relaxed">
            @Model.Content
        </div>

        @if (User.Identity.IsAuthenticated)
        {
            <button onclick="toggleReplyForm(@Model.Id)" class="text-xs text-slate-500 hover:text-accent font-medium transition-colors">
                Reply
            </button>

            <form id="reply-form-@Model.Id" asp-controller="Post" asp-action="AddComment" method="post" class="hidden mt-3 ml-2">
                <input type="hidden" name="PostId" value="@Model.PostId" />
                <input type="hidden" name="ParentId" value="@Model.Id" />
                <input type="hidden" name="PostSlug" value="@ViewContext.RouteData.Values["slug"]" />

                <textarea name="Content" rows="2" required placeholder="Write a reply..."
                      class="w-full bg-background border border-slate-700 rounded-lg p-2 text-sm text-white focus:ring-accent focus:border-accent"></textarea>
                <div class="mt-2">
                    <button type="submit" class="text-xs bg-secondary hover:bg-slate-700 text-white px-3 py-1 rounded border border-slate-600">
                        Reply
                    </button>
                </div>
            </form>
        }

        @if (Model.Replies.Any())
        {
            <div class="mt-4 pl-4 border-l-2 border-slate-800 space-y-6">
                @foreach (var reply in Model.Replies)
                {
                    <partial name="_CommentPartial" model="reply" />
                }
            </div>
        }
    </div>
</div>